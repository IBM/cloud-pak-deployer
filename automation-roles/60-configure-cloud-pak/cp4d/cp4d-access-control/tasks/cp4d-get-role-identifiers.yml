---
- name: Get Cloud Pak for Data role identifiers for all roles
  uri:
    url: 'https://{{ _current_cp4d_url.stdout }}/usermgmt/v1/roles'
    method: GET
    headers:
      Authorization: "Bearer {{ _cp4d_bearer_token }}"
      Content-Type: "application/json"
    return_content: yes
    validate_certs: no
    status_code: 200
  register: _cp4d_all_roles

- debug:
    var: _cp4d_user_group_roles

- debug:
    var: _cp4d_all_roles

- set_fact:
    _cp4d_user_group_role_ids: []
    _cp4d_user_group_role_ids_list: []

- include_tasks: cp4d-add-role-identifier.yml
  loop: "{{ _cp4d_user_group_roles }}"
  loop_control:
    loop_var: _cp4d_user_group_role

- debug:
    var: _cp4d_user_group_role_ids

- set_fact:
    _cp4d_user_group_role_ids_list: "[ {{ '\"' + _cp4d_user_group_role_ids | join('\",\"') + '\"'}} ]"
  when: _cp4d_user_group_role_ids != []