---
- name: Check if old scheduler project is already on the cluster
  shell: |
    oc get ns cpd-scheduler
  failed_when: False
  register: _get_cpd_scheduler

- set_fact:
    _scheduler_project: "{{ scheduling_service_project }}"
  when: _get_cpd_scheduler.rc != 0

- set_fact:
    _scheduler_project: cpd-scheduler
  when: _get_cpd_scheduler.rc == 0

- include_tasks: check-install-scheduler.yml
  when: _cp4d_install_scheduler

- include_tasks: uninstall-scheduler.yml
  when: not _cp4d_install_scheduler